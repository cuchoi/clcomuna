import unicodedata

def remove_accents(input_str):
    '''
    Removes accents and special characters
    Input:  string
    Output: Modified string
    '''

    nfkd_form = unicodedata.normalize('NFKD', input_str)
    return u"".join([c for c in nfkd_form if not unicodedata.combining(c)])

def get_code(name):
    '''
    Given the name of a comuna, returns the code of that comuna
    Input:  string
    Output: string
    '''
    comunas = {'AISEN': '11201',
             'ALGARROBO': '05602',
             'ALHUE': '13502',
             'ALTO BIOBIO': '08314',
             'ALTO DEL CARMEN': '03302',
             'ALTO HOSPICIO': '01107',
             'ANCUD': '10202',
             'ANDACOLLO': '04103',
             'ANGOL': '09201',
             'ANTARTICA': '12202',
             'ANTOFAGASTA': '02101',
             'ANTUCO': '08302',
             'ARAUCO': '08202',
             'ARICA': '15101',
             'BUIN': '13402',
             'BULNES': '08402',
             'CABILDO': '05402',
             'CABO DE HORNOS (EX NAVARINO)': '12201',
             'CABO DE HORNOS': '12201',
             'NAVARINO': '12201',
             'CABRERO': '08303',
             'CALAMA': '02201',
             'CALBUCO': '10102',
             'CALDERA': '03102',
             'CALERA': '05502',
             'CALERA DE TANGO': '13403',
             'CALLE LARGA': '05302',
             'CAMARONES': '15102',
             'CAMINA': '01402',
             'CANELA': '04202',
             'CANETE': '08203',
             'CARAHUE': '09102',
             'CARTAGENA': '05603',
             'CASABLANCA': '05102',
             'CASTRO': '10201',
             'CATEMU': '05702',
             'CAUQUENES': '07201',
             'CERRILLOS': '13102',
             'CERRO NAVIA': '13103',
             'CHAITEN': '10401',
             'CHANARAL': '03201',
             'CHANCO': '07202',
             'CHEPICA': '06302',
             'CHIGUAYANTE': '08103',
             'CHILE CHICO': '11401',
             'CHILLAN': '08401',
             'CHILLAN VIEJO': '08406',
             'CHIMBARONGO': '06303',
             'CHOLCHOL': '09121',
             'CHONCHI': '10203',
             'CISNES': '11202',
             'COBQUECURA': '08403',
             'COCHAMO': '10103',
             'COCHRANE': '11301',
             'CODEGUA': '06102',
             'COELEMU': '08404',
             'COIHAIQUE': '11101',
             'COIHUECO': '08405',
             'COINCO': '06103',
             'COLBUN': '07402',
             'COLCHANE': '01403',
             'COLINA': '13301',
             'COLLIPULLI': '09202',
             'COLTAUCO': '06104',
             'COMBARBALA': '04302',
             'CONCEPCION': '08101',
             'CONCHALI': '13104',
             'CONCON': '05103',
             'CONSTITUCION': '07102',
             'CONTULMO': '08204',
             'COPIAPO': '03101',
             'COQUIMBO': '04102',
             'CORONEL': '08102',
             'CORRAL': '14102',
             'CUNCO': '09103',
             'CURACAUTIN': '09203',
             'CURACAVI': '13503',
             'CURACO DE VELEZ': '10204',
             'CURANILAHUE': '08205',
             'CURARREHUE': '09104',
             'CUREPTO': '07103',
             'CURICO': '07301',
             'DALCAHUE': '10205',
             'DIEGO DE ALMAGRO': '03202',
             'DONIHUE': '06105',
             'EL BOSQUE': '13105',
             'EL CARMEN': '08407',
             'EL MONTE': '13602',
             'EL QUISCO': '05604',
             'EL TABO': '05605',
             'EMPEDRADO': '07104',
             'ERCILLA': '09204',
             'ESTACION CENTRAL': '13106',
             'FLORIDA': '08104',
             'FREIRE': '09105',
             'FREIRINA': '03303',
             'FRESIA': '10104',
             'FRUTILLAR': '10105',
             'FUTALEUFU': '10402',
             'FUTRONO': '14202',
             'GALVARINO': '09106',
             'GENERAL LAGOS': '15202',
             'GORBEA': '09107',
             'GRANEROS': '06106',
             'GUAITECAS': '11203',
             'HIJUELAS': '05503',
             'HUALAIHUE': '10403',
             'HUALANE': '07302',
             'HUALPEN': '08112',
             'HUALQUI': '08105',
             'HUARA': '01404',
             'HUASCO': '03304',
             'HUECHURABA': '13107',
             'ILLAPEL': '04201',
             'INDEPENDENCIA': '13108',
             'IQUIQUE': '01101',
             'ISLA DE MAIPO': '13603',
             'ISLA DE PASCUA': '05201',
             'JUAN FERNANDEZ': '05104',
             'LA CISTERNA': '13109',
             'LA CRUZ': '05504',
             'LA ESTRELLA': '06202',
             'LA FLORIDA': '13110',
             'LA GRANJA': '13111',
             'LA HIGUERA': '04104',
             'LA LIGUA': '05401',
             'LA PINTANA': '13112',
             'LA REINA': '13113',
             'LA SERENA': '04101',
             'LA UNION': '14201',
             'LAGO RANCO': '14203',
             'LAGO VERDE': '11102',
             'LAGUNA BLANCA': '12102',
             'LAJA': '08304',
             'LAMPA': '13302',
             'LANCO': '14103',
             'LAS CABRAS': '06107',
             'LAS CONDES': '13114',
             'LAUTARO': '09108',
             'LEBU': '08201',
             'LICANTEN': '07303',
             'LIMACHE': '05802',
             'LINARES': '07401',
             'LITUECHE': '06203',
             'LLAILLAY': '05703',
             'LLANQUIHUE': '10107',
             'LO BARNECHEA': '13115',
             'LO ESPEJO': '13116',
             'LO PRADO': '13117',
             'LOLOL': '06304',
             'LONCOCHE': '09109',
             'LONGAVI': '07403',
             'LONQUIMAY': '09205',
             'LOS ALAMOS': '08206',
             'LOS ANDES': '05301',
             'LOS ANGELES': '08301',
             'LOS LAGOS': '14104',
             'LOS MUERMOS': '10106',
             'LOS SAUCES': '09206',
             'LOS VILOS': '04203',
             'LOTA': '08106',
             'LUMACO': '09207',
             'MACHALI': '06108',
             'MACUL': '13118',
             'MAFIL': '14105',
             'MAIPU': '13119',
             'MALLOA': '06109',
             'MARCHIHUE': '06204',
             'MARIA ELENA': '02302',
             'MARIA PINTO': '13504',
             'MARIQUINA': '14106',
             'MAULE': '07105',
             'MAULLIN': '10108',
             'MEJILLONES': '02102',
             'MELIPEUCO': '09110',
             'MELIPILLA': '13501',
             'MOLINA': '07304',
             'MONTE PATRIA': '04303',
             'MOSTAZAL': '06110',
             'MULCHEN': '08305',
             'NACIMIENTO': '08306',
             'NANCAGUA': '06305',
             'NATALES': '12401',
             'NAVIDAD': '06205',
             'NEGRETE': '08307',
             'NINHUE': '08408',
             'NIQUEN': '08409',
             'NOGALES': '05506',
             'NUEVA IMPERIAL': '09111',
             'NUNOA': '13120',
             'OLIVAR': '06111',
             'OLLAGUE': '02202',
             'OLMUE': '05803',
             'OSORNO': '10301',
             'OVALLE': '04301',
             'Oâ€™HIGGINS': '11302',
             'PADRE HURTADO': '13604',
             'PADRE LAS CASAS': '09112',
             'PAIGUANO': '04105',
             'PAILLACO': '14107',
             'PAINE': '13404',
             'PALENA': '10404',
             'PALMILLA': '06306',
             'PANGUIPULLI': '14108',
             'PANQUEHUE': '05704',
             'PAPUDO': '05403',
             'PAREDONES': '06206',
             'PARRAL': '07404',
             'PEDRO AGUIRRE CERDA': '13121',
             'PELARCO': '07106',
             'PELLUHUE': '07203',
             'PEMUCO': '08410',
             'PENAFLOR': '13605',
             'PENALOLEN': '13122',
             'PENCAHUE': '07107',
             'PENCO': '08107',
             'PERALILLO': '06307',
             'PERQUENCO': '09113',
             'PETORCA': '05404',
             'PEUMO': '06112',
             'PICA': '01405',
             'PICHIDEGUA': '06113',
             'PICHILEMU': '06201',
             'PINTO': '08411',
             'PIRQUE': '13202',
             'PITRUFQUEN': '09114',
             'PLACILLA': '06308',
             'PORTEZUELO': '08412',
             'PORVENIR': '12301',
             'POZO ALMONTE': '01401',
             'PRIMAVERA': '12302',
             'PROVIDENCIA': '13123',
             'PUCHUNCAVI': '05105',
             'PUCON': '09115',
             'PUDAHUEL': '13124',
             'PUENTE ALTO': '13201',
             'PUERTO MONTT': '10101',
             'PUERTO OCTAY': '10302',
             'PUERTO VARAS': '10109',
             'PUMANQUE': '06309',
             'PUNITAQUI': '04304',
             'PUNTA ARENAS': '12101',
             'PUQUELDON': '10206',
             'PUREN': '09208',
             'PURRANQUE': '10303',
             'PUTAENDO': '05705',
             'PUTRE': '15201',
             'PUYEHUE': '10304',
             'QUEILEN': '10207',
             'QUELLON': '10208',
             'QUEMCHI': '10209',
             'QUILACO': '08308',
             'QUILICURA': '13125',
             'QUILLECO': '08309',
             'QUILLON': '08413',
             'QUILLOTA': '05501',
             'QUILPUE': '05801',
             'QUINCHAO': '10210',
             'QUINTA DE TILCOCO': '06114',
             'QUINTA NORMAL': '13126',
             'QUINTERO': '05107',
             'QUIRIHUE': '08414',
             'RANCAGUA': '06101',
             'RANQUIL': '08415',
             'RAUCO': '07305',
             'RECOLETA': '13127',
             'RENAICO': '09209',
             'RENCA': '13128',
             'RENGO': '06115',
             'REQUINOA': '06116',
             'RETIRO': '07405',
             'RINCONADA': '05303',
             'RIO BUENO': '14204',
             'RIO CLARO': '07108',
             'RIO HURTADO': '04305',
             'RIO IBANEZ': '11402',
             'RIO NEGRO': '10305',
             'RIO VERDE': '12103',
             'ROMERAL': '07306',
             'SAAVEDRA': '09116',
             'SAGRADA FAMILIA': '07307',
             'SALAMANCA': '04204',
             'SAN ANTONIO': '05601',
             'SAN BERNARDO': '13401',
             'SAN CARLOS': '08416',
             'SAN CLEMENTE': '07109',
             'SAN ESTEBAN': '05304',
             'SAN FABIAN': '08417',
             'SAN FELIPE': '05701',
             'SAN FERNANDO': '06301',
             'SAN GREGORIO': '12104',
             'SAN IGNACIO': '08418',
             'SAN JAVIER': '07406',
             'SAN JOAQUIN': '13129',
             'SAN JOSE DE MAIPO': '13203',
             'SAN JUAN DE LA COSTA': '10306',
             'SAN MIGUEL': '13130',
             'SAN NICOLAS': '08419',
             'SAN PABLO': '10307',
             'SAN PEDRO': '13505',
             'SAN PEDRO DE ATACAMA': '02203',
             'SAN PEDRO DE LA PAZ': '08108',
             'SAN RAFAEL': '07110',
             'SAN RAMON': '13131',
             'SAN ROSENDO': '08310',
             'SAN VICENTE': '06117',
             'SANTA BARBARA': '08311',
             'SANTA CRUZ': '06310',
             'SANTA JUANA': '08109',
             'SANTA MARIA': '05706',
             'SANTIAGO': '13101',
             'SANTO DOMINGO': '05606',
             'SIERRA GORDA': '02103',
             'TALAGANTE': '13601',
             'TALCA': '07101',
             'TALCAHUANO': '08110',
             'TALTAL': '02104',
             'TEMUCO': '09101',
             'TENO': '07308',
             'TEODORO SCHMIDT': '09117',
             'TIERRA AMARILLA': '03103',
             'TILTIL': '13303',
             'TIMAUKEL': '12303',
             'TIRUA': '08207',
             'TOCOPILLA': '02301',
             'TOLTEN': '09118',
             'TOME': '08111',
             'TORRES DEL PAINE': '12402',
             'TORTEL': '11303',
             'TRAIGUEN': '09210',
             'TREGUACO': '08420',
             'TUCAPEL': '08312',
             'VALDIVIA': '14101',
             'VALLENAR': '03301',
             'VALPARAISO': '05101',
             'VICHUQUEN': '07309',
             'VICTORIA': '09211',
             'VICUNA': '04106',
             'VILCUN': '09119',
             'VILLA ALEGRE': '07407',
             'VILLA ALEMANA': '05804',
             'VILLARRICA': '09120',
             'VINA DEL MAR': '05109',
             'VITACURA': '13132',
             'YERBAS BUENAS': '07408',
             'YUMBEL': '08313',
             'YUNGAY': '08421',
             'ZAPALLAR': '05405'}

    comuna = remove_accents(name).upper()

    try:
        return comunas[comuna]
    except Exception as e:
        print ("Could not find code for: ", comuna)
